version: '3.8'
services:
  backend:
    build: ./backend
    container_name: bizdnaii_backend
    restart: always
    ports: ["8005:8000"]
    env_file: [.env]
    volumes: [./backend:/app]
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8000/"]
      interval: 10s
      timeout: 5s
      retries: 5
  bot:
    build: ./bot
    container_name: bizdnaii_bot
    restart: always
    env_file: [.env]
    volumes: [./bot:/app]
    depends_on: 
      backend:
        condition: service_healthy
  widget:
    build: ./frontend/widget
    container_name: bizdnaii_widget
    ports: ["80:80", "443:443"]
    volumes: [./certs:/etc/nginx/certs]
